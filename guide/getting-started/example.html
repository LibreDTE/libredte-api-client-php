<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
            <title>LibreDTE API Client</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">LibreDTE API Client</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category -docs-libredte-api-client-php">
            <h2 class="phpdocumentor-sidebar__category-header">Docs-Libredte-Api-Client-Php</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/getting-started/index.html#empezando" class="">Empezando</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/getting-started/legal.html#terminos-y-condiciones-de-uso" class="">Términos y Condiciones de Uso</a>
                
            </li>
                    <li>
                <a href="guide/getting-started/install.html#instalacion" class="">Instalación</a>
                
            </li>
                    <li>
                <a href="guide/getting-started/setup.html#configuracion" class="">Configuración</a>
                
            </li>
                    <li>
                <a href="guide/getting-started/example.html#ejemplo" class="">Ejemplo</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/dev/index.html#desarrollo" class="">Desarrollo</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/dev/unit-test.html#pruebas-unitarias" class="">Pruebas unitarias</a>
                
            </li>
            </ul>

                        </section>
                <section class="phpdocumentor-sidebar__category -namespaces">
            <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="namespaces/libredte.html" class="">libredte</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="namespaces/libredte-api-client.html" class="">api_client</a>
                
            </li>
            </ul>

                        </section>
                <section class="phpdocumentor-sidebar__category -packages">
            <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/libredte.html" class="">libredte</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="packages/libredte-api.html" class="">api</a>
                
            </li>
            </ul>

                        </section>
            
    <section class="phpdocumentor-sidebar__category -reports">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category -indices">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section class="section " id="ejemplo">
            <h1>Ejemplo</h1>

            
    <p>El siguiente es un ejemplo básico de cómo obtener un documento DTE emitido usando el cliente de API de LibreDTE:</p>

            <pre><code class="language-php">&lt;?php

# Definición de directorio autoload. Necesario si se usa la versión de GitHub.
require_once __DIR__ . &#039;/vendor/autoload.php&#039;;

# Importación de biblioteca de LibreDTE
use libredte\api_client\ApiClient;

# Instanciación de cliente de API
$client = new ApiClient();

# RUT del emisor sin Dígito Verificador.
$emisor_rut = 12345678;
# Filtros a aplicar en la búsqueda de DTEs.
$filtros = [
    &#039;fecha_desde&#039; =&gt; &#039;2024-10-25&#039;,
    &#039;fecha_hasta&#039; =&gt; date(&#039;Y-m-d&#039;),
];

# Recurso a consumir.
$resource = sprintf(&#039;/dte/dte_tmps/buscar/%d&#039;, $emisor_rut);

# Se efectua la solicitud HTTP y se guarda la respuesta. En esta variable están el estado, cuerpo, etc.
$response = $client-&gt;post($resource, $filtros);

echo &quot;Status: &quot;.$response[&#039;status&#039;][&#039;code&#039;].&quot;\n&quot;;

if ($response[&#039;status&#039;][&#039;code&#039;] != 200) {
    echo $response[&#039;body&#039;].&quot;\n&quot;;
} else {
    $documentos = $response[&#039;body&#039;];
    $dte_id = &#039;T&#039;.$documentos[0][&#039;dte&#039;].&#039;F&#039;.$documentos[0][&#039;folio&#039;];

    echo &quot;\nDTEs Temporales: \n&quot;;
    echo &quot;\n&quot;,&#039;N DOCUMENTOS: &#039;,count($documentos),&quot;\n&quot;;
    echo &quot;\n&quot;,&#039;DTE ID: &#039;,$dte_id,&quot;\n&quot;;
    echo &quot;\n&quot;,&#039;DTE FECHA: &#039;,$documentos[0][&#039;fecha&#039;],&quot;\n&quot;;
}</code></pre>

            <section class="section " id="desgloce-de-ejemplo">
            <h2>Desgloce de ejemplo</h2>

            
    <p>Antes de probar, integrar y/o utilizar el cliente de API, necesitas haber definido previamente las variables de entorno.</p>

            <div class="phpdocumentor-admonition seealso">
                        <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
        <article>
        
    <p>Para más información sobre este paso, referirse al la guía en Configuración.</p>

    </article>
</div>

            
    <p>Se empieza por importar e instanciar el cliente de API.</p>

            <pre><code class="language-php"># Definición de directorio autoload. Necesario si se usa la versión de GitHub.
require_once __DIR__ . &#039;/vendor/autoload.php&#039;;

# Importación de biblioteca de LibreDTE
use libredte\api_client\ApiClient;

# Instanciación de cliente de API
$client = new ApiClient();</code></pre>

            
    <p>Luego, se definen las variables a utilizar.</p>

            <pre><code class="language-php"># RUT del emisor sin Dígito Verificador.
$emisor_rut = 12345678;
# Filtros a aplicar en la búsqueda de DTEs.
$filtros = [
    &#039;fecha_desde&#039; =&gt; &#039;2015-01-01&#039;,
    &#039;fecha_hasta&#039; =&gt; date(&#039;Y-m-d&#039;),
];</code></pre>

            
    <p>Más adelante, se arma el recurso a utilizar, se consume, y se obtiene su respuesta HTTP.</p>

            <pre><code class="language-php"># Recurso a consumir.
$resource = sprintf(&#039;/dte/dte_tmps/buscar/%d&#039;, $emisor_rut);

# Se efectua la solicitud HTTP y se guarda la respuesta.
$response = $client-&gt;post($resource, $filtros);</code></pre>

            
    <p><code>$response</code>
 contiene toda la información de la respuesta HTTP, desde el cuerpo hasta el código de estado.</p>

            
    <p>Por último, se despliega en consola el resultado. Si el código de la respuesta HTTP no es 200, se mostrará el mensaje de error. Si es 200, se desplegarán los documentos consultados.</p>

            <pre><code class="language-php">echo &quot;Status: &quot;.$response[&#039;status&#039;][&#039;code&#039;].&quot;\n&quot;;

if ($response[&#039;status&#039;][&#039;code&#039;] != 200) {
    echo $response[&#039;body&#039;].&quot;\n&quot;;
} else {
    $documentos = $response[&#039;body&#039;];
    $dte_id = &#039;T&#039;.$documentos[0][&#039;dte&#039;].&#039;F&#039;.$documentos[0][&#039;folio&#039;];

    echo &quot;\nDTEs Temporales: \n&quot;;
    echo &quot;\n&quot;,&#039;N DOCUMENTOS: &#039;,count($documentos),&quot;\n&quot;;
    echo &quot;\n&quot;,&#039;DTE ID: &#039;,$dte_id,&quot;\n&quot;;
    echo &quot;\n&quot;,&#039;DTE FECHA: &#039;,$documentos[0][&#039;fecha&#039;],&quot;\n&quot;;
}</code></pre>

            <div class="phpdocumentor-admonition important">
        <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <article>
        
    <p>Este ejemplo solo funciona con DTEs temporales.</p>

    </article>
</div>

            <div class="phpdocumentor-admonition seealso">
                        <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
        <article>
        
    <p>Para saber más sobre los parámetros posibles y el cómo consumir las API, referirse a la <a href="https://developers.libredte.cl/">documentación de LibreDTE.</a></p>

    </article>
</div>

    </section>

    </section>

                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>
